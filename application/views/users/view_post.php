
<div class="container">
    <div class="container-post">
        <?php if (!empty($posts)): ?>
<!--        --><?php //foreach ($posts as $posts):?>
        <div class="post">
            <div class="header-container">
                <div class="avata">
                    <img src="/public/img/avata1.jpg" alt="">
                </div>
                <div class="descrip">
                    <b><?php echo $posts['product'];?></b>
                    <p>DUong VILLA</p>

                </div>
            </div>
            <div class="container-img">
                <div class="img">
                    <img src="/public/img/img1.jpg" alt="">
                </div>

                <div class="eye"><img src="/public/img/eye-xl.png" alt=""></div>
                <div class="after">
                </div>

            </div>
            <div class="context">
                <div class="caption">
                    <p>Fanny pack beard pop-up twee tote bag DIY. Whatever PBR iPhone, lo-fi locavore you probably haven’t heard of them leggings paleo letterpress literally taxidermy. Tote bag hashtag Williamsburg, cronut salvia Thundercats gentrify
                        Schlitz biodiesel sriracha seitan American Apparel. Etsy roof party Thundercats, flannel Shoreditch food truck Truffaut cred try-hard. Paleo aesthetic Wes Anderson cliche. Sartorial Echo Park Helvetica master cleanse tote bag.
                        Crucifix vinyl retro, health goth banh mi single-origin…</p>
                </div>
                <div class="action">
                    <p class="number_heart">6</p>
                    <img class="heart" src="/public/img/icons8-heart-26.png" alt="">
                    <p class="number_cmt">9</p>
                    <img class="cmt" src="/public/img/icons8-topic-26.png" alt="">
                </div>
                <div class="all-cmt">
                    <div class="title-cmt cmts ">
                        Xem tat ca 12 binh luan
                    </div>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div> <br>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div>

                </div>
                <form action="">
                    <input type="text" name="search" placeholder="Comment..">
                    <button type="submit" class="sendCmt" ></button>
                </form>
            </div>

        </div>
        <?php endif?>
        <div class="post">
            <div class="header-container">
                <div class="avata">
                    <img src="/public/img/avata1.jpg" alt="">
                </div>
                <div class="descrip">
                    <b>nestkp</b>
                    <p>TARA VILLA</p>

                </div>
            </div>
            <div class="container-img">
                <div class="img">
                    <img src="/public/img/post2.jpg" alt="">
                </div>

                <div class="eye"><img src="/public/img/eye-xl.png" alt=""></div>
                <div class="after">
                </div>

            </div>
            <div class="context">
                <div class="caption">
                    <p>Fanny pack beard pop-up twee tote bag DIY. Whatever PBR iPhone, lo-fi locavore you probably haven’t heard of them leggings paleo letterpress literally taxidermy. Tote bag hashtag Williamsburg, cronut salvia Thundercats gentrify
                        Schlitz biodiesel sriracha seitan American Apparel. Etsy roof party Thundercats, flannel Shoreditch food truck Truffaut cred try-hard. Paleo aesthetic Wes Anderson cliche. Sartorial Echo Park Helvetica master cleanse tote bag.
                        Crucifix vinyl retro, health goth banh mi single-origin…</p>
                </div>
                <div class="action">
                    <p class="number_heart">6</p>
                    <img class="heart" src="/public/img/icons8-heart-26.png" alt="">
                    <p class="number_cmt">9</p>
                    <img class="cmt" src="/public/img/icons8-topic-26.png" alt="">
                </div>
                <div class="all-cmt">
                    <div class="title-cmt cmts ">
                        Xem tat ca 12 binh luan
                    </div>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div> <br>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div>

                </div>
                <form action="">
                    <input type="text" name="search" placeholder="Comment..">
                    <button type="submit" class="sendCmt" ></button>

                </form>
            </div>

        </div>
        <div class="post">
            <div class="header-container">
                <div class="avata">
                    <img src="/public/img/avata1.jpg" alt="">
                </div>
                <div class="descrip">
                    <b>nestkp</b>
                    <p>TARA VILLA</p>

                </div>
            </div>
            <div class="container-img">
                <div class="img">
                    <img src="/public/img/post3.jpg" alt="">
                </div>

                <div class="eye"><img src="/public/img/eye-xl.png" alt=""></div>
                <div class="after">
                </div>

            </div>
            <div class="context">
                <div class="caption">
                    <p>Fanny pack beard pop-up twee tote bag DIY. Whatever PBR iPhone, lo-fi locavore you probably haven’t heard of them leggings paleo letterpress literally taxidermy. Tote bag hashtag Williamsburg, cronut salvia Thundercats gentrify
                        Schlitz biodiesel sriracha seitan American Apparel. Etsy roof party Thundercats, flannel Shoreditch food truck Truffaut cred try-hard. Paleo aesthetic Wes Anderson cliche. Sartorial Echo Park Helvetica master cleanse tote bag.
                        Crucifix vinyl retro, health goth banh mi single-origin…</p>
                </div>
                <div class="action">
                    <p class="number_heart">6</p>
                    <img class="heart" src="/public/img/icons8-heart-26.png" alt="">
                    <p class="number_cmt">9</p>
                    <img class="cmt" src="/public/img/icons8-topic-26.png" alt="">
                </div>
                <div class="all-cmt">
                    <div class="title-cmt cmts ">
                        Xem tat ca 12 binh luan
                    </div>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div> <br>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div>

                </div>
                <form action="">
                    <input type="text" name="search" placeholder="Comment..">
                    <button type="submit" class="sendCmt" ></button>

                </form>
            </div>

        </div>
        <div class="post">
            <div class="header-container">
                <div class="avata">
                    <img src="/public/img/avata1.jpg" alt="">
                </div>
                <div class="descrip">
                    <b>nestkp</b>
                    <p>TARA VILLA</p>

                </div>
            </div>
            <div class="container-img">
                <div class="img">
                    <img src="/public/img/post4.jpg" alt="">
                </div>

                <div class="eye"><img src="/public/img/eye-xl.png" alt=""></div>
                <div class="after">
                </div>

            </div>
            <div class="context">
                <div class="caption">
                    <p>Fanny pack beard pop-up twee tote bag DIY. Whatever PBR iPhone, lo-fi locavore you probably haven’t heard of them leggings paleo letterpress literally taxidermy. Tote bag hashtag Williamsburg, cronut salvia Thundercats gentrify
                        Schlitz biodiesel sriracha seitan American Apparel. Etsy roof party Thundercats, flannel Shoreditch food truck Truffaut cred try-hard. Paleo aesthetic Wes Anderson cliche. Sartorial Echo Park Helvetica master cleanse tote bag.
                        Crucifix vinyl retro, health goth banh mi single-origin…</p>
                </div>
                <div class="action">
                    <p class="number_heart">6</p>
                    <img class="heart" src="/public/img/icons8-heart-26.png" alt="">
                    <p class="number_cmt">9</p>
                    <img class="cmt" src="/public/img/icons8-topic-26.png" alt="">
                </div>
                <div class="all-cmt">
                    <div class="title-cmt cmts ">
                        Xem tat ca 12 binh luan
                    </div>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div> <br>
                    <div class="title-cmt cmt">
                        <div class="name-cmt">nestkp</div>
                        <div class="text-cmt">@born_pst ยังไม่รู้หรอ</div>
                    </div>

                </div>
                <form action="">
                    <input type="text" name="search" placeholder="Comment..">
                    <button type="submit" class="sendCmt" ></button>


                </form>
            </div>

        </div>

    </div>
    <div class="profile-parent">
        <div class="profile ">
            <div class="row-avata">
                <div class="img-avata">
                    <img src="/public/img/avata.jpg" alt="">
                </div>
                <div class="name-avata">Lalalisa</div>
                <div class="transfer">
                    <a href="#">Chuyen</a>
                </div>
            </div>
            <div class="suggest-add">
                <div class="suggest-text">
                    <div class="text-1">Goi y ket ban</div>
                    <a href="#" class="text-all">Xem tat ca</a>
                </div>
                <div class="add">
                    <div class="img-avata">
                        <img src="/public/img/avata.jpg" alt="">
                    </div>
                    <div class="name-avata">Lalalisa</div>
                    <div class="transfer">
                        <a href="#">Chuyen</a>
                    </div>
                </div>
                <div class="add">
                    <div class="img-avata">
                        <img src="/public/img/avata.jpg" alt="">
                    </div>
                    <div class="name-avata">Lalalisa</div>
                    <div class="transfer">
                        <a href="#">Chuyen</a>
                    </div>
                </div>
                <div class="add">
                    <div class="img-avata">
                        <img src="/public/img/avata.jpg" alt="">
                    </div>
                    <div class="name-avata">Lalalisa</div>
                    <div class="transfer">
                        <a href="#">Chuyen</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="pagination">
    <a href="#">&laquo;</a>
    <a href="#">1</a>
    <a class="active" href="#">2</a>
    <a href="#">3</a>
    <a href="#">4</a>
    <a href="#">5</a>
    <a href="#">6</a>
    <a href="#">7</a>
    <a href="#">&raquo;</a>
</div>



<script type="text/javascript">
    window.onload = function (){
        busy = true;
        getPosts(() =>{busy = false})
    }
    var busy = false;
    var page =1;
    var limit=3;
    window.onscroll = function(ev) {
        if(((window.innerHeight + window.scrollY) >= document.body.offsetHeight))
        {
            if(busy)
                return;
            busy = true;
            // getPosts(()=>{busy=false});
            setTimeout( ()=>  getPosts(()=>{busy=false}), 500);


        }
        return false;
    };

    function getPosts(callback=()=>{})
    {
        let xhr = new XMLHttpRequest();

        xhr.open('GET', "/v1/users/vGetHomePosts?limit="+limit+"&page="+page);

        // request state change event
        xhr.onreadystatechange = function() {

            // request completed?
            if (xhr.readyState !== 4) return;

            if (xhr.status === 200) {
                // request successful - show response
                let data = JSON.parse(xhr.responseText);
                if (data.posts.length == 0) {
                    setTimeout(callback, 5000)
                } else {
                    page++
                    callback()
                }
                let postsContainer = document.getElementById("posts-container")
                if (data.posts) {
                    for (let postIndex in data.posts){
                        postsContainer.innerHTML+=
                            '<div id="myBtn" onclick="showPost(\'' + data.posts[postIndex].image  + '\', '
                            + '\'' + data.posts[postIndex].post_description  + '\'' +
                            '' +
                            ')"   class="image-child-vp ">'
                            + '<img src="'
                            + data.posts[postIndex].image
                            + '" />'
                            + '<div class="after-vp"></div>'
                            + '<div class="after-vp-tym">'
                            + '<p style="margin-right: 4px;"> '
                            + 8
                            +'</p>'
                            + '<img src="/public/img/hearted" alt="">'
                            + '</div>'
                            + ' </div>'
                    }
                }
            }
            else {
                // request errord
                console.log('HTTP error', xhr.status, xhr.statusText);
            }
        };

// start request
        xhr.send();
    }



    function followClick(){

        let xhr = new XMLHttpRequest();


        xhr.onreadystatechange = function() {
            // request completed?
            if (xhr.readyState !== 4) return;
            if (xhr.status === 200) {
                let data = JSON.parse(xhr.responseText);
                document.getElementById("follow").innerHTML = data.follow;
            }

        }
        xhr.open('GET', "/v1/users/follow/<?php echo $user['id']?>" );
        // start request
        xhr.send();
    }




</script>